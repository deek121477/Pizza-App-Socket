{"version":3,"sources":["server.js"],"names":["require","config","express","ejs","expressLayout","app","env","PORT","mongoose","flash","path","MONGO_CONNECTION_URL","useNewUrlParser","useCreateIndex","useUnifiedTopology","useFindAndModify","connection","once","console","log","err","secret","process","COOKIE_SECRET","resave","create","cookie","maxAge","mongoUrl","use","json","res","next","locals","session","req","set","join","__dirname","concat"],"mappings":"aAAAA,QAAQ,UAAUC,SAClB,IAAMC,QAAUF,QAAQ,WADxBA,IAAQE,UAGFC,IAAMH,QAAQ,OAFdE,KAAOF,QAAU,QAIjBI,cAAgBJ,QAAQ,uBAHxBK,KAAMH,QAAZI,IAAAC,MAAA,IAKMC,SAAWR,QAAQ,YAJnBG,QAAMH,QAAZ,mBAMMS,MAAQT,QAAQ,iBALhBU,aAAeV,QAArB,iBAGAQ,SAAMA,QAAWR,QAAQM,IAAAK,qBAAzB,CAAAC,iBAAA,EAAAC,gBAAA,EAAAC,oBAAA,EAAAC,kBAAA,IAUA,IAAMC,WAAaR,SAASQ,WAT5BA,WAAaC,KAAGjB,OAAQ,WAWpBkB,QAAQC,IAAI,2BAXhB,MACW,SAAAC,GAYPF,QAAQC,IAAI,0BAL2GJ,IAAAA,IAAAA,QAAAA,CAAxEM,OAAnDC,QAAAhB,IAAAiB,cACAC,QAAMR,EACNA,MAAAA,aAAgBS,OAAQ,CACpBP,SAAYI,QAAAhB,IAAAK,uBAEZO,mBAAY,EACfQ,OAMD,CAAAC,OAAA,UAKIC,IAAAA,IAAAA,SAGMD,IAAAA,IAAAA,QAAQ,OAAA,WAAVtB,IAAgCwB,IAAA3B,QAAA4B,QAMxCzB,IAAIwB,IAAIpB,SAAAA,EAAKsB,EAGbC,GAMGD,EAAIE,OAAOC,QAAUC,EAAID,QALzBF,MAMAA,IAAAA,IAAI5B,eACNC,IAED+B,IAAA,QAAA1B,KAAA2B,KAAAC,UAAA,qBAIAjC,IAAI+B,IAAI,cAAe,OADvB/B,QAAQ,eAARA,CAAsBgC,KAGtBrC,IAAAA,OAAQ,IAAA,WAIJkB,QAAQC,IAAR,qBAAAoB,OAAiChC","file":"server.min.js","sourcesContent":["require('dotenv').config()\r\nconst express = require('express')\r\nconst app = express()\r\nconst ejs = require('ejs')\r\nconst path = require('path')\r\nconst expressLayout = require('express-ejs-layouts')\r\nconst PORT = process.env.PORT || 3000\r\nconst mongoose = require('mongoose')\r\nconst session = require('express-session')\r\nconst flash = require('express-flash')\r\nconst MongoDbStore = require('connect-mongo')\r\n\r\n\r\n// Database connection\r\n\r\n\r\nmongoose.connect(process.env.MONGO_CONNECTION_URL, { useNewUrlParser: true, useCreateIndex:true, useUnifiedTopology: true, useFindAndModify : true });\r\nconst connection = mongoose.connection;\r\nconnection.once('open', () => {\r\n    console.log('Database connected...');\r\n}).catch(err => {\r\n    console.log('Connection failed...')\r\n});\r\n\r\n\r\n\r\n\r\n\r\n// Session config\r\napp.use(session({\r\nsecret: process.env.COOKIE_SECRET,\r\nresave: false,\r\nstore: MongoDbStore.create({\r\n    mongoUrl: process.env.MONGO_CONNECTION_URL\r\n}),\r\nsaveUninitialized: false,\r\ncookie: { maxAge: 1000 * 60 * 60 * 24 } // 24 hour\r\n}))\r\n\r\n\r\n\r\n\r\napp.use(flash())\r\n\r\n\r\n//Assets\r\napp.use(express.static('public'))\r\napp.use(express.json())\r\n\r\n//Global middlewares\r\napp.use((req, res, next) =>{\r\n   res.locals.session = req.session\r\n   next()\r\n})\r\n\r\n//set template engine\r\n\r\napp.use(expressLayout)\r\napp.set('views', path.join(__dirname, '/resources/views'))\r\napp.set('view engine', 'ejs')\r\n\r\nrequire('./routes/web')(app)\r\n\r\n\r\napp.listen(3000, () => {\r\n    console.log(`Listening on port ${PORT}`)\r\n})"]}